<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:st1="urn:schemas-microsoft-com:office:smarttags"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1251">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 11">
<meta name=Originator content="Microsoft Word 11">
<link rel=File-List href="10%20ФАЙЛЫ.files/filelist.xml">
<link rel=Edit-Time-Data href="10%20ФАЙЛЫ.files/editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>10. Файлы</title>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="City"/>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="place" downloadurl="http://www.5iantlavalamp.com/"/>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="metricconverter"/>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>user</o:Author>
  <o:Template>Normal</o:Template>
  <o:LastAuthor>user</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>1</o:TotalTime>
  <o:Created>2011-03-30T14:11:00Z</o:Created>
  <o:LastSaved>2011-03-30T14:11:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>2836</o:Words>
  <o:Characters>16169</o:Characters>
  <o:Lines>134</o:Lines>
  <o:Paragraphs>37</o:Paragraphs>
  <o:CharactersWithSpaces>18968</o:CharactersWithSpaces>
  <o:Version>11.5606</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:SpellingState>Clean</w:SpellingState>
  <w:GrammarState>Clean</w:GrammarState>
  <w:PunctuationKerning/>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:Compatibility>
   <w:BreakWrappedTables/>
   <w:SnapToGridInCell/>
   <w:WrapTextWithPunct/>
   <w:UseAsianBreakRules/>
   <w:DontGrowAutofit/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" LatentStyleCount="156">
 </w:LatentStyles>
</xml><![endif]--><!--[if !mso]><object
 classid="clsid:38481807-CA0E-42D2-BF39-B33AF135CC4D" id=ieooui></object>
<style>
st1\:*{behavior:url(#ieooui) }
</style>
<![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:"MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;
	mso-font-alt:"\FF2D\FF33 \660E\671D";
	mso-font-charset:128;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:-1610612033 1757936891 16 0 131231 0;}
@font-face
	{font-family:"Lucida Console";
	panose-1:2 11 6 9 4 5 4 2 2 4;
	mso-font-charset:204;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:-2147482993 6144 0 0 31 0;}
@font-face
	{font-family:"\@MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;
	mso-font-charset:128;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:-1610612033 1757936891 16 0 131231 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
h1
	{mso-style-next:Обычный;
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:16.0pt;
	font-family:Arial;
	mso-font-kerning:16.0pt;}
h2
	{mso-style-next:Обычный;
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:14.0pt;
	font-family:Arial;
	font-style:italic;}
p.MsoBodyText, li.MsoBodyText, div.MsoBodyText
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:widow-orphan;
	font-size:14.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	font-weight:bold;}
p.H1, li.H1, div.H1
	{mso-style-name:_H1;
	mso-style-parent:"Заголовок 1";
	mso-style-link:"_H1 Знак";
	margin-top:18.0pt;
	margin-right:0cm;
	margin-bottom:18.0pt;
	margin-left:0cm;
	text-align:center;
	page-break-before:always;
	mso-pagination:no-line-numbers;
	mso-outline-level:1;
	font-size:20.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	text-transform:uppercase;
	font-weight:bold;
	mso-bidi-font-weight:normal;}
p.P, li.P, div.P
	{mso-style-name:_P;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-indent:35.45pt;
	mso-pagination:none;
	font-size:14.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
span.Code
	{mso-style-name:_Code;
	mso-style-parent:"";
	mso-ansi-font-size:12.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Lucida Console";
	mso-ascii-font-family:"Lucida Console";
	mso-hansi-font-family:"Lucida Console";}
p.H2, li.H2, div.H2
	{mso-style-name:_H2;
	mso-style-parent:"Заголовок 2";
	margin-top:18.0pt;
	margin-right:0cm;
	margin-bottom:18.0pt;
	margin-left:0cm;
	text-align:center;
	mso-pagination:none;
	page-break-after:avoid;
	mso-outline-level:2;
	mso-hyphenate:none;
	font-size:18.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	text-transform:uppercase;
	mso-ansi-language:EN-US;
	font-weight:bold;
	mso-bidi-font-weight:normal;}
p.IMG, li.IMG, div.IMG
	{mso-style-name:_IMG;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:none;
	font-size:14.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
span.H10
	{mso-style-name:"_H1 Знак";
	mso-style-locked:yes;
	mso-style-parent:"";
	mso-style-link:_H1;
	mso-ansi-font-size:20.0pt;
	mso-bidi-font-size:20.0pt;
	text-transform:uppercase;
	mso-ansi-language:RU;
	mso-fareast-language:RU;
	mso-bidi-language:AR-SA;
	font-weight:bold;
	mso-bidi-font-weight:normal;}
span.SpellE
	{mso-style-name:"";
	mso-spl-e:yes;}
span.GramE
	{mso-style-name:"";
	mso-gram-e:yes;}
@page Section1
	{size:595.3pt 841.9pt;
	margin:2.0cm 42.5pt 2.0cm 3.0cm;
	mso-header-margin:35.4pt;
	mso-footer-margin:35.4pt;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
 @list l0
	{mso-list-id:497504782;
	mso-list-type:hybrid;
	mso-list-template-ids:895883948 68747279 68747289 68747291 68747279 68747289 68747291 68747279 68747289 68747291;}
@list l0:level1
	{mso-level-tab-stop:71.45pt;
	mso-level-number-position:left;
	margin-left:71.45pt;
	text-indent:-18.0pt;}
@list l1
	{mso-list-id:1473907973;
	mso-list-type:hybrid;
	mso-list-template-ids:1918283264 68747289 68747289 68747291 68747279 68747289 68747291 68747279 68747289 68747291;}
@list l1:level1
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:71.45pt;
	mso-level-number-position:left;
	margin-left:71.45pt;
	text-indent:-18.0pt;}
ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Обычная таблица";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
	mso-para-margin:0cm;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
</style>
<![endif]-->
</head>

<body lang=RU style='tab-interval:35.4pt'>

<div class=Section1>

<p class=H1 style='mso-outline-level:2'><a name="_Toc266272302"></a><a
name="_Toc265340342"></a><a name="_Toc263373113"><span style='mso-bookmark:
_Toc265340342'><span style='mso-bookmark:_Toc266272302'>10. Файлы</span></span></a></p>

<p class=H2 style='mso-outline-level:3'><a name="_Toc266272303"></a><a
name="_Toc265340343"></a><a name="_Toc263373114"><span style='mso-bookmark:
_Toc265340343'><span style='mso-bookmark:_Toc266272303'><span style='mso-ansi-language:
RU'>10.1. Общие сведения</span></span></span></a><span style='mso-ansi-language:
RU'><o:p></o:p></span></p>

<p class=P><b style='mso-bidi-font-weight:normal'>Файл </b>– это именованная
область, хранящая данные (программа или любая другая информация) на каком-либо
носителе (дискета, винчестер, <span lang=EN-US style='mso-ansi-language:EN-US'>CD</span>).
Файл, как и массив, – это совокупность данных, потому они немного похожи.
Различия:</p>

<p class=P style='margin-left:71.45pt;text-indent:-18.0pt;mso-list:l0 level1 lfo1;
tab-stops:list 71.45pt'><![if !supportLists]><span style='mso-list:Ignore'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><![endif]>Файлы,
в отличие от массивов, располагаются не в оперативной памяти, а на жестких
дисках или на внешних носителях. Хотя файл может располагаться на так
называемом электронном диске (в оперативной памяти).</p>

<p class=P style='margin-left:71.45pt;text-indent:-18.0pt;mso-list:l0 level1 lfo1;
tab-stops:list 71.45pt'><![if !supportLists]><span style='mso-list:Ignore'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><![endif]>Файл
не имеет фиксированной длины, т.е. может увеличиваться и уменьшаться.</p>

<p class=P style='margin-left:71.45pt;text-indent:-18.0pt;mso-list:l0 level1 lfo1;
tab-stops:list 71.45pt'><![if !supportLists]><span style='mso-list:Ignore'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><![endif]>Перед
работой с файлом его необходимо открыть, а после работы – закрыть.</p>

<p class=P><a name="_Файловая_система"></a><a name="_Текстовые_и_бинарные_2"></a>Файлами
в языке Си могут быть любые устройства, начиная с файла на дискете, винчестере
и заканчивая, к примеру, принтером.</p>

<p class=P>Для <span class=SpellE>избежания</span> дальнейшей путаницы под файлом
будем понимать поток, связанный с конкретным файлом на магнитном диске.</p>

<p class=P>Существует два основных режима доступа к файлу:</p>

<p class=P style='margin-left:71.45pt;text-indent:-18.0pt;mso-list:l1 level1 lfo2;
tab-stops:list 71.45pt'><![if !supportLists]><span style='mso-list:Ignore'>a.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><![endif]>Текстовый</p>

<p class=P style='margin-left:71.45pt;text-indent:-18.0pt;mso-list:l1 level1 lfo2;
tab-stops:list 71.45pt'><![if !supportLists]><span style='mso-list:Ignore'>b.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><![endif]>Бинарный
(двоичный)</p>

<p class=P>Текстовые форматы представляют <span class=GramE>данные</span> как
простой текст доступный пользователям.</p>

<p class=P>В общем случае текстовые файлы состоят из обычных печатных символов,
а также пробелов, символов новой строки, и, возможно, символов табуляции.</p>

<p class=P>В текстовом файле, например, число 1850 представлено четырьмя
символами 1,8,5,0, которые идут друг за другом подобно строке “<st1:metricconverter
ProductID="1850”" w:st="on">1850”</st1:metricconverter>. В коде <span
lang=EN-US style='mso-ansi-language:EN-US'>ASCII</span> эти четыре символа
имеют представление 0<span lang=EN-US style='mso-ansi-language:EN-US'>x</span>31
0<span lang=EN-US style='mso-ansi-language:EN-US'>x</span>38 0<span lang=EN-US
style='mso-ansi-language:EN-US'>x</span>35 0<span lang=EN-US style='mso-ansi-language:
EN-US'>x</span>30 соответственно. </p>

<p class=P>С другой стороны, в двоичном файле данных величины записываются
таким способом, каким они хранятся<span style='mso-spacerun:yes'>  </span>в
памяти. Поэтому попытки просмотреть<span style='mso-spacerun:yes'>  </span>или
обработать двоичный файл при помощи обычного текстового редактора приводит к
полной бессмыслице.</p>

<p class=P>К примеру, то же число 1850 будет представлено как 0х073а, т.е.
байтами 0х07 и 0х3<span lang=EN-US style='mso-ansi-language:EN-US'>a</span> .</p>

<p class=P>Поясним <span class=GramE>на примере, как</span> это число будет
записано в бинарном файле и как в текстовом.</p>

<p class=P>На рис. 10.1 представлена целая величина 1850 как <span lang=EN-US
style='mso-ansi-language:EN-US'>ASCII</span> строка в текстовом файле и как
двухбайтовая величина в двоичном файле, используя порядок от младших байтов к
старшим. </p>

<p class=P><o:p>&nbsp;</o:p></p>

<p class=IMG><!--[if gte vml 1]><v:shapetype id="_x0000_t75" coordsize="21600,21600"
 o:spt="75" o:preferrelative="t" path="m@4@5l@4@11@9@11@9@5xe" filled="f"
 stroked="f">
 <v:stroke joinstyle="miter"/>
 <v:formulas>
  <v:f eqn="if lineDrawn pixelLineWidth 0"/>
  <v:f eqn="sum @0 1 0"/>
  <v:f eqn="sum 0 0 @1"/>
  <v:f eqn="prod @2 1 2"/>
  <v:f eqn="prod @3 21600 pixelWidth"/>
  <v:f eqn="prod @3 21600 pixelHeight"/>
  <v:f eqn="sum @0 0 1"/>
  <v:f eqn="prod @6 1 2"/>
  <v:f eqn="prod @7 21600 pixelWidth"/>
  <v:f eqn="sum @8 21600 0"/>
  <v:f eqn="prod @7 21600 pixelHeight"/>
  <v:f eqn="sum @10 21600 0"/>
 </v:formulas>
 <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>
 <o:lock v:ext="edit" aspectratio="t"/>
</v:shapetype><v:shape id="_x0000_i1025" type="#_x0000_t75" style='width:505.5pt;
 height:234.75pt'>
 <v:imagedata src="10%20ФАЙЛЫ.files/image001.gif" o:title="121"/>
</v:shape><![endif]--><![if !vml]><img width=674 height=313
src="10%20ФАЙЛЫ.files/image001.gif" v:shapes="_x0000_i1025"><![endif]></p>

<p class=IMG><o:p>&nbsp;</o:p></p>

<p class=P align=center style='text-align:center;text-indent:0cm'>Рис. 10.1.
Представление целой величины 1850</p>

<p class=P><o:p>&nbsp;</o:p></p>

<p class=P><span lang=EN-US style='mso-ansi-language:EN-US'>EOF</span> –
признак конца файла.</p>

<p class=P>Таким образом, видно, что в нашем случае бинарный файл требует
меньше места, чем текстовый. Но это вовсе не означает, что необходимо
использовать только бинарные файлы. Бывают случаи, когда текстовые файлы
выглядят более предпочтительными. К примеру, если необходимо, чтобы
пользователь мог сразу просмотреть результаты выполнения программы. Т.е. мог
открыть файл текстовым редактором, не загружая специальную программу.</p>

<p class=P>С другой стороны, бинарные файлы могут пригодиться как раз для
противоположных целей. </p>

<p class=H2 style='mso-outline-level:3'><a name="_Toc266272304"></a><a
name="_Toc265340344"></a><a name="_Toc263373115"></a><a
name="_Открытие_и_закрытие"></a><a name="_Открытие_и_закрытие_1"></a><span
style='mso-bookmark:_Toc266272304'><span style='mso-bookmark:_Toc265340344'><span
style='mso-bookmark:_Toc263373115'><span style='mso-ansi-language:RU'>10.2.
Открытие и закрытие файлов</span></span></span></span><span style='mso-ansi-language:
RU'><o:p></o:p></span></p>

<p class=P><span style='mso-spacerun:yes'> </span>Для открытия файла
используется функция <span class=SpellE><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='mso-ansi-language:EN-US'>fopen</span></b></span>(), которая
при успешном открытии возвращает указатель на структуру типа <span lang=EN-US
style='mso-ansi-language:EN-US'>FILE</span>. </p>

<p class=P>Этот указатель называется указателем на файл. Структура <span
lang=EN-US style='mso-ansi-language:EN-US'>FILE</span> связана с физическим
файлом и содержит всю необходимую информацию для работы с ним (указатель на
текущую позицию в файле, тип доступа и др.). </p>

<p class=P><b style='mso-bidi-font-weight:normal'><span style='letter-spacing:
1.0pt'><span style='mso-spacerun:yes'> </span><o:p></o:p></span></b></p>

<p class=P><span class=SpellE><span class=Code><span style='font-size:12.0pt'>typedef</span></span></span><span
class=Code><span style='font-size:12.0pt'> <span class=SpellE>struct</span><o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'>{<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'><span
style='mso-spacerun:yes'>  </span><span class=SpellE>short</span> <span
class=SpellE>level</span>;<span style='mso-spacerun:yes'>          </span>//
Число <span class=GramE>оставшихся</span> в буфере<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'><span
style='mso-spacerun:yes'>                        </span>// <span class=GramE>непрочитанных</span>
байт. Буфер обычно<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'><span
style='mso-spacerun:yes'>                        </span>// имеет размер 512
байт. Как только<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'><span
style='mso-spacerun:yes'>                        </span>// <span class=SpellE>level</span>
равен 0, в буфер (<span class=GramE>в</span> ОП) из<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'><span
style='mso-spacerun:yes'>                        </span>// файла читается
следующий блок<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'><span
style='mso-spacerun:yes'>                        </span>// данных<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'><o:p>&nbsp;</o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'><span
style='mso-spacerun:yes'>  </span><span class=SpellE>unsigned</span> <span
class=SpellE>flags</span>;<span style='mso-spacerun:yes'>       </span>// Флаг
статуса файла: чтение,<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'><span
style='mso-spacerun:yes'>                        </span>// запись, дополнение<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'><o:p>&nbsp;</o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'><span
style='mso-spacerun:yes'>  </span><span class=SpellE>char</span> <span
class=SpellE>fd</span>;<span style='mso-spacerun:yes'>              </span>//
Дескриптор файла<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'><span
style='mso-spacerun:yes'>                        </span>// (<span class=GramE>число</span>
определяющее номер файла)<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'><o:p>&nbsp;</o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'><span
style='mso-spacerun:yes'>  </span><span class=SpellE>unsigned</span> <span
class=SpellE>char</span> <span class=SpellE>hold</span>;<span
style='mso-spacerun:yes'>   </span>// <span class=SpellE>Непереданный</span>
символ<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'><span
style='mso-spacerun:yes'>                        </span>// (ungetc-символ)<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'><o:p>&nbsp;</o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'><span
style='mso-spacerun:yes'>  </span><span class=SpellE>short</span> <span
class=SpellE>bsize</span>;<span style='mso-spacerun:yes'>          </span>//
Размер <span class=GramE>внутреннего</span> промежуточного<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'><span
style='mso-spacerun:yes'>                        </span>// буфера<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'><o:p>&nbsp;</o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'><span
style='mso-spacerun:yes'>  </span><span class=SpellE>unsigned</span> <span
class=SpellE>char</span> <span class=SpellE>buffer</span>; // Значение
указателя для доступа<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'><span
style='mso-spacerun:yes'>                        </span>// внутри буфера:
задаёт начало<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'><span
style='mso-spacerun:yes'>                        </span>// буфера, начало
строки или текущее<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'><span
style='mso-spacerun:yes'>                        </span>// значение указателя
внутри буфера <span class=GramE>в</span><o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'><span
style='mso-spacerun:yes'>                        </span>// зависимости от
режима буферизации <o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'><o:p>&nbsp;</o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'><span
style='mso-spacerun:yes'>  </span><span class=SpellE>unsigned</span> <span
class=SpellE>char</span> * <span class=SpellE>curp</span>; // Текущее значение
указателя <span class=GramE>для</span><o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'><span
style='mso-spacerun:yes'>                        </span>// доступа внутри
буфера: задаёт<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'><span
style='mso-spacerun:yes'>                        </span>// текущую позицию в
буфере <span class=GramE>для</span><o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'><span
style='mso-spacerun:yes'>                        </span>// обмена с программой<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'><o:p>&nbsp;</o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'><span
style='mso-spacerun:yes'>  </span><span class=SpellE>unsigned</span> <span
class=SpellE>istemp</span>;<span style='mso-spacerun:yes'>      </span>// Флаг
временного файла<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'><o:p>&nbsp;</o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'><span
style='mso-spacerun:yes'>  </span><span class=SpellE>short</span> <span
class=SpellE>token</span>;<span style='mso-spacerun:yes'>          </span>//
Флаг сбоя при работе с файлом<o:p></o:p></span></span></p>

<p class=P><span class=GramE><span class=Code><span style='font-size:12.0pt'>}
FILE; // Описание структуры FILE.</span></span></span><span class=Code><span
style='font-size:12.0pt'><o:p></o:p></span></span></p>

<p class=P><o:p>&nbsp;</o:p></p>

<p class=P>Возвращаемое функцией <span class=SpellE><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-ansi-language:EN-US'>fopen</span></b></span>()
значение нужно сохранить и использовать при дальнейшей работе с открытым
файлом.</p>

<p class=P>Если произошла ошибка при открытии файла, то возвращается <span
lang=EN-US style='mso-ansi-language:EN-US'>NULL</span>. </p>

<p class=P>Никогда не изменяйте указатель на файл! Это может привести к
непредвиденным результатам.</p>

<p class=P>Функция открытия файла <span class=SpellE><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-ansi-language:EN-US'>fopen</span></b></span>()
принимает два параметра, оба являются указателями на строку. Как уже говорилось
выше, строковые литералы (строки, строковые константы) также представляют собой
указатели на строки, т.е. возможно их использование в качестве параметров этой
функции.</p>

<p class=P><o:p>&nbsp;</o:p></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-ansi-language:EN-US'>FILE *<span class=SpellE><span class=GramE>fopen</span></span><span
class=GramE>(</span>char *filename, char *mode);<o:p></o:p></span></span></p>

<p class=P><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=P>Здесь <span lang=EN-US style='mso-ansi-language:EN-US'>filename</span>
– указатель на строку, содержащую имя открываемого файла, при необходимости – с
путём к нему (строка оформляется по правилам <span lang=EN-US style='mso-ansi-language:
EN-US'>MS</span>-<span lang=EN-US style='mso-ansi-language:EN-US'>DOS</span>); <span
lang=EN-US style='mso-ansi-language:EN-US'>mode</span> – указатель на строку,
описывающую режим открытия. </p>

<p class=P>Пример записи:</p>

<p class=P><span class=Code><span style='font-size:12.0pt'>...<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'>FILE *<span
class=SpellE>p</span>;<o:p></o:p></span></span></p>

<p class=P><span class=SpellE><span class=Code><span style='font-size:12.0pt'>p</span></span></span><span
class=Code><span style='font-size:12.0pt'> = <span class=SpellE>fopen</span>(“1.doc”,
”<span class=SpellE>r+b</span>”); // в качестве пути к файлу<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'><span
style='mso-spacerun:yes'>                           </span>// используется
литерал<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'><o:p>&nbsp;</o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'>или<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'><o:p>&nbsp;</o:p></span></span></p>

<p class=P><span class=SpellE><span class=Code><span style='font-size:12.0pt'>char</span></span></span><span
class=Code><span style='font-size:12.0pt'> *<span class=SpellE>s</span> =
”1.doc”;<o:p></o:p></span></span></p>

<p class=P><span class=SpellE><span class=Code><span style='font-size:12.0pt'>p</span></span></span><span
class=Code><span style='font-size:12.0pt'> = <span class=SpellE>fopen</span>(<span
class=SpellE>s</span>, ”<span class=SpellE>r+b</span>”); // в качестве пути к
файлу используется<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'><span
style='mso-spacerun:yes'>                     </span>// указатель на строку<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'>...<o:p></o:p></span></span></p>

<p class=P><o:p>&nbsp;</o:p></p>

<p class=P>Объявление нескольких файловых переменных<span
style='mso-spacerun:yes'>  </span>следует делать с большой долей
внимательности.</p>

<p class=P>К примеру, такое объявление </p>

<p class=P><o:p>&nbsp;</o:p></p>

<p class=P><span class=Code><span style='font-size:12.0pt'>...<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'>FILE *<span
class=SpellE>p</span>, p1;<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'>...<o:p></o:p></span></span></p>

<p class=P><o:p>&nbsp;</o:p></p>

<p class=P>будет неверным, так как р<span class=GramE>1</span> будет переменной
типа <span lang=EN-US style='mso-ansi-language:EN-US'>FILE</span>, а не
указателем.</p>

<p class=P>В таблице 10.1 приведены возможные режимы открытия файла.</p>

<p class=MsoBodyText style='text-indent:27.0pt'><o:p>&nbsp;</o:p></p>

<p class=P align=center style='text-align:center;text-indent:0cm'>Таблица 10.1.
Режимы открытия файлов</p>

<p class=IMG><o:p>&nbsp;</o:p></p>

<div align=center>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;border:none;mso-border-alt:
 solid windowtext .5pt;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:
 .5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width=93 valign=top style='width:69.7pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoBodyText><span style='font-weight:normal;mso-bidi-font-weight:
  bold;mso-no-proof:yes'>“</span><span lang=EN-US style='mso-ansi-language:
  EN-US;font-weight:normal;mso-bidi-font-weight:bold;mso-no-proof:yes'>r</span><span
  style='font-weight:normal;mso-bidi-font-weight:bold;mso-no-proof:yes'>”<o:p></o:p></span></p>
  </td>
  <td width=543 valign=top style='width:407.3pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoBodyText align=left style='text-align:left'><span
  style='font-weight:normal;mso-bidi-font-weight:bold'>Открыть файл для чтения.
  Файл должен существовать<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=93 valign=top style='width:69.7pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoBodyText><span style='font-weight:normal;mso-bidi-font-weight:
  bold;mso-no-proof:yes'>“</span><span lang=EN-US style='mso-ansi-language:
  EN-US;font-weight:normal;mso-bidi-font-weight:bold;mso-no-proof:yes'>w</span><span
  style='font-weight:normal;mso-bidi-font-weight:bold;mso-no-proof:yes'>”<o:p></o:p></span></p>
  <p class=MsoBodyText><span style='font-weight:normal;mso-bidi-font-weight:
  bold;mso-no-proof:yes'><o:p>&nbsp;</o:p></span></p>
  </td>
  <td width=543 valign=top style='width:407.3pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoBodyText align=left style='text-align:left'><span
  style='font-weight:normal;mso-bidi-font-weight:bold'>Открыть файл для записи.
  Если файл существует, то его содержимое теряется. Если нет – файл создается.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=93 valign=top style='width:69.7pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoBodyText><span style='font-weight:normal;mso-bidi-font-weight:
  bold;mso-no-proof:yes'>“</span><span lang=EN-US style='mso-ansi-language:
  EN-US;font-weight:normal;mso-bidi-font-weight:bold;mso-no-proof:yes'>a</span><span
  style='font-weight:normal;mso-bidi-font-weight:bold;mso-no-proof:yes'>”<o:p></o:p></span></p>
  <p class=MsoBodyText><span style='font-weight:normal;mso-bidi-font-weight:
  bold;mso-no-proof:yes'><o:p>&nbsp;</o:p></span></p>
  </td>
  <td width=543 valign=top style='width:407.3pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoBodyText align=left style='text-align:left'><span
  style='font-weight:normal;mso-bidi-font-weight:bold'>Открыть файл для записи
  в конец файла. Если файл не существует, то он создается.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width=93 valign=top style='width:69.7pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoBodyText><span style='font-weight:normal;mso-bidi-font-weight:
  bold;mso-no-proof:yes'>“</span><span lang=EN-US style='mso-ansi-language:
  EN-US;font-weight:normal;mso-bidi-font-weight:bold;mso-no-proof:yes'>r</span><span
  style='font-weight:normal;mso-bidi-font-weight:bold;mso-no-proof:yes'>+”<o:p></o:p></span></p>
  <p class=MsoBodyText><span style='font-weight:normal;mso-bidi-font-weight:
  bold;mso-no-proof:yes'><o:p>&nbsp;</o:p></span></p>
  </td>
  <td width=543 valign=top style='width:407.3pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoBodyText align=left style='text-align:left'><span
  style='font-weight:normal;mso-bidi-font-weight:bold'>Открыть файл для записи
  и чтения. Файл должен существовать.<o:p></o:p></span></p>
  <p class=MsoBodyText align=left style='text-align:left'><span
  style='font-weight:normal;mso-bidi-font-weight:bold'>Содержимое файла не
  теряется.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td width=93 valign=top style='width:69.7pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoBodyText><span style='font-weight:normal;mso-bidi-font-weight:
  bold;mso-no-proof:yes'>“</span><span lang=EN-US style='mso-ansi-language:
  EN-US;font-weight:normal;mso-bidi-font-weight:bold;mso-no-proof:yes'>w</span><span
  style='font-weight:normal;mso-bidi-font-weight:bold;mso-no-proof:yes'>+”<o:p></o:p></span></p>
  <p class=MsoBodyText><span style='font-weight:normal;mso-bidi-font-weight:
  bold;mso-no-proof:yes'><o:p>&nbsp;</o:p></span></p>
  </td>
  <td width=543 valign=top style='width:407.3pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoBodyText align=left style='text-align:left'><span
  style='font-weight:normal;mso-bidi-font-weight:bold'>Открыть файл для чтения
  и записи. Если файл не существует, то он создается. Если файл существует, то
  его содержимое теряется.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5;mso-yfti-lastrow:yes'>
  <td width=93 valign=top style='width:69.7pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoBodyText><span style='font-weight:normal;mso-bidi-font-weight:
  bold;mso-no-proof:yes'>“а+”<o:p></o:p></span></p>
  <p class=MsoBodyText><span style='font-weight:normal;mso-bidi-font-weight:
  bold;mso-no-proof:yes'><o:p>&nbsp;</o:p></span></p>
  </td>
  <td width=543 valign=top style='width:407.3pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoBodyText align=left style='text-align:left'><span
  style='font-weight:normal;mso-bidi-font-weight:bold'>Открыть файл для записи
  и чтения в конец файла. Если файл не существует, то он создается.<o:p></o:p></span></p>
  </td>
 </tr>
</table>

</div>

<p class=P><o:p>&nbsp;</o:p></p>

<p class=P>К комбинациям вышеперечисленных литералов могут быть добавлены также
&quot;<b style='mso-bidi-font-weight:normal'><span lang=EN-US style='mso-ansi-language:
EN-US'>t</span></b>&quot; либо &quot;<b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='mso-ansi-language:EN-US'>b</span></b>&quot;:</p>

<p class=P><o:p>&nbsp;</o:p></p>

<p class=P>&quot;<b style='mso-bidi-font-weight:normal'><span lang=EN-US
style='mso-ansi-language:EN-US'>t</span></b>&quot;<span
style='mso-spacerun:yes'>  </span>Открыть файл в текстовом режиме. </p>

<p class=P>&quot;<b style='mso-bidi-font-weight:normal'><span lang=EN-US
style='mso-ansi-language:EN-US'>b</span></b>&quot; Открыть файл в бинарном
режиме.</p>

<p class=P><o:p>&nbsp;</o:p></p>

<p class=P>Возможны следующие режимы доступа:”<span lang=EN-US
style='mso-ansi-language:EN-US'>w</span>+<span lang=EN-US style='mso-ansi-language:
EN-US'>b</span>”, “<span class=SpellE><span lang=EN-US style='mso-ansi-language:
EN-US'>wb</span></span>+”, “<span class=SpellE><span lang=EN-US
style='mso-ansi-language:EN-US'>rw</span></span>+”, “<span lang=EN-US
style='mso-ansi-language:EN-US'>w</span>+<span lang=EN-US style='mso-ansi-language:
EN-US'>t</span>”и т.д.</p>

<p class=P>После работы с файлом, файл должен быть закрыт функцией <span
class=SpellE><b style='mso-bidi-font-weight:normal'><span lang=EN-US
style='mso-ansi-language:EN-US'>fclose</span></b></span>(). Для этого
необходимо в указанную функцию передать указатель на структуру <span
lang=EN-US style='mso-ansi-language:EN-US'>FILE</span> (указатель на файл),
который был получен при открытии функцией <span class=GramE><b
style='mso-bidi-font-weight:normal'><span lang=EN-US style='mso-ansi-language:
EN-US'>f</span></b></span><b style='mso-bidi-font-weight:normal'>оре</b><b
style='mso-bidi-font-weight:normal'><span lang=EN-US style='mso-ansi-language:
EN-US'>n</span></b>().</p>

<p class=P>Если программа завершает работу нормально, т.е. либо <span
class=SpellE>main</span>() возвращает управление операционной системе, либо
вызывается <span class=SpellE>exit</span>(), то все файлы закрываются
автоматически.</p>

<p class=P>В случае аварийного завершения работы программы, например в случае
краха или вызова функции <span class=SpellE>abort</span>() , файлы не
закрываются.</p>

<p class=P>Пример закрытия:</p>

<p class=P><o:p>&nbsp;</o:p></p>

<p class=P><span class=Code><span style='font-size:12.0pt'>...<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'>FILE *<span
class=SpellE>p</span>;<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'>...<o:p></o:p></span></span></p>

<p class=P><span class=SpellE><span class=Code><span style='font-size:12.0pt'>fclose</span></span></span><span
class=Code><span style='font-size:12.0pt'>(<span class=SpellE>p</span>); <o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'>...<o:p></o:p></span></span></p>

<p class=P><o:p>&nbsp;</o:p></p>

<p class=P>Приведем пример программы, открывающей файлы для записи и чтения в
текстовом режиме.</p>

<p class=P><o:p>&nbsp;</o:p></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'>#<span class=SpellE>include</span> &lt;<span class=SpellE>stdio.h</span>&gt;
// подключаем заголовочный файл для работы<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'><span style='mso-spacerun:yes'>                   </span></span></span><span
class=Code><span lang=EN-US style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho";mso-ansi-language:EN-US'>// </span></span><span class=Code><span
style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho"'>функций</span></span><span
class=Code><span lang=EN-US style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho";mso-ansi-language:EN-US'> <span class=SpellE><span class=GramE>printf</span></span><span
class=GramE>(</span>), <span class=SpellE>scanf</span>()<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'>Void <span
class=GramE>main(</span>void)<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'>{<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'><span style='mso-spacerun:yes'>  </span>FILE *<span class=SpellE>in</span>;<span
style='mso-spacerun:yes'>        </span>// указатель на структуру FILE<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'><span style='mso-spacerun:yes'>  </span></span></span><span
class=GramE><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'>if</span></span></span><span
class=Code><span lang=EN-US style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho";mso-ansi-language:EN-US'> ((in = <span class=SpellE>fopen</span>(&quot;d:\\ex1_in.txt&quot;,
&quot;<span class=SpellE>rt</span>&quot;)) == NULL)<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span></span></span><span class=Code><span
style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho"'>// файл
d:\ex1_in.txt должен существовать<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'><span style='mso-spacerun:yes'>  </span>// открывается файл для
чтения<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'><span style='mso-spacerun:yes'>  </span>// <span class=SpellE><span
class=GramE>e</span>сли</span> файл не существует, то <span class=SpellE>fopen</span>()
вернет NULL и<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'><span style='mso-spacerun:yes'>  </span>// осуществится выход из
программы<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'><span style='mso-spacerun:yes'>  </span>{<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'><span style='mso-spacerun:yes'>    </span><span class=SpellE>printf</span>(&quot;Невозможно
открыть входной <span class=SpellE>файл.\n</span>&quot;);<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'><span style='mso-spacerun:yes'>    </span></span></span><span
class=GramE><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'>return</span></span></span><span
class=Code><span lang=EN-US style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho";mso-ansi-language:EN-US'>;<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>}<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span><span class=GramE>else</span><o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span><span class=SpellE><span class=GramE>printf</span></span><span
class=GramE>(</span>&quot; </span></span><span class=Code><span
style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho"'>Входной</span></span><span
class=Code><span style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'> </span></span><span class=Code><span
style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho"'>файл</span></span><span
class=Code><span style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'> </span></span><span class=Code><span
style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho"'>открыт</span></span><span
class=Code><span lang=EN-US style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho";mso-ansi-language:EN-US'> \n&quot;);<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span><span class=SpellE><span class=GramE>fclose</span></span><span
class=GramE>(</span>in);<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'>}<o:p></o:p></span></span></p>

<p class=P><span style='mso-fareast-font-family:"MS Mincho";mso-no-proof:yes'><span
style='mso-tab-count:1'>         </span><span style='mso-spacerun:yes'>       
</span><span style='mso-tab-count:1'> </span><span
style='mso-spacerun:yes'> </span><o:p></o:p></span></p>

<p class=P><span style='mso-fareast-font-family:"MS Mincho"'>Далее приведен
пример программы </span>открытия<span style='mso-fareast-font-family:"MS Mincho"'>
файлов в бинарном режиме. <o:p></o:p></span></p>

<p class=P><span style='mso-fareast-font-family:"MS Mincho"'><o:p>&nbsp;</o:p></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'>#include &lt;<span
class=SpellE>stdio.h</span>&gt;<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></span></p>

<p class=P><span class=GramE><span class=Code><span lang=EN-US
style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho";mso-ansi-language:
EN-US'>void</span></span></span><span class=Code><span lang=EN-US
style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho";mso-ansi-language:
EN-US'> main(void)<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'>{<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>FILE *in;<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span><span class=GramE>if</span> ((in = <span
class=SpellE>fopen</span>(&quot;d:\\ex1_in.txt&quot;, &quot;<span class=SpellE>rb</span>&quot;))
== NULL)<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span></span></span><span class=Code><span
style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho"'>// файл
d:\ex1_in.txt должен существовать<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'><span style='mso-spacerun:yes'>  </span>{<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'><span style='mso-spacerun:yes'>    </span><span class=SpellE>printf</span>(&quot;Невозможно
открыть входной <span class=SpellE>файл.\n</span>&quot;);<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'><span style='mso-spacerun:yes'>    </span></span></span><span
class=GramE><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'>return</span></span></span><span
class=Code><span lang=EN-US style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho";mso-ansi-language:EN-US'>;<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>}<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span><span class=GramE>else</span><o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span><span class=SpellE><span class=GramE>printf</span></span><span
class=GramE>(</span>&quot;</span></span><span class=Code><span
style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho"'>Входной</span></span><span
class=Code><span style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'> </span></span><span class=Code><span
style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho"'>файл</span></span><span
class=Code><span style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'> </span></span><span class=Code><span
style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho"'>открыт</span></span><span
class=Code><span lang=EN-US style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho";mso-ansi-language:EN-US'> \n&quot;);<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span><span class=SpellE><span class=GramE>fclose</span></span><span
class=GramE>(</span>in);<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'>}<o:p></o:p></span></span></p>

<p class=H2 style='mso-outline-level:3'><a name="_Toc266272305"></a><a
name="_Toc265340345"></a><a name="_Toc263373116"><span style='mso-bookmark:
_Toc265340345'><span style='mso-bookmark:_Toc266272305'><span style='mso-ansi-language:
RU'>10.3. Функции </span></span></span></a><a name=START></a><span
style='mso-bookmark:_Toc263373116'><span style='mso-bookmark:_Toc265340345'><span
style='mso-bookmark:_Toc266272305'><span style='mso-ansi-language:RU'>ввода-вывода
для работы <br>
с текстовыми файлами</span></span></span></span><span style='mso-ansi-language:
RU'><o:p></o:p></span></p>

<p class=P>Для работы с текстовыми файлами в библиотеке языка Си содержится
множество удобных функций, далее будут рассмотрены самые распространенные: <span
class=SpellE><b style='mso-bidi-font-weight:normal'><span lang=EN-US
style='mso-ansi-language:EN-US'>fprintf</span></b></span><b style='mso-bidi-font-weight:
normal'>(), </b><span class=SpellE><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='mso-ansi-language:EN-US'>fscanf</span></b></span><b
style='mso-bidi-font-weight:normal'>(), </b><span class=SpellE><b
style='mso-bidi-font-weight:normal'><span lang=EN-US style='mso-ansi-language:
EN-US'>fgets</span></b></span><b style='mso-bidi-font-weight:normal'>(), </b><span
class=SpellE><b style='mso-bidi-font-weight:normal'><span lang=EN-US
style='mso-ansi-language:EN-US'>fputs</span></b></span><b style='mso-bidi-font-weight:
normal'>(), </b><span class=SpellE><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='mso-ansi-language:EN-US'>fgetc</span></b></span><b
style='mso-bidi-font-weight:normal'>(), </b><span class=SpellE><b
style='mso-bidi-font-weight:normal'><span lang=EN-US style='mso-ansi-language:
EN-US'>fputc</span></b></span><b style='mso-bidi-font-weight:normal'>()</b>.
Формат параметров этих функций очень похож на формат функций <span
class=SpellE><b style='mso-bidi-font-weight:normal'><span lang=EN-US
style='mso-ansi-language:EN-US'>printf</span></b></span><b style='mso-bidi-font-weight:
normal'>(), </b><span class=SpellE><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='mso-ansi-language:EN-US'>scanf</span></b></span><b
style='mso-bidi-font-weight:normal'>(), </b><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-ansi-language:EN-US'>gets</span>(), </b><b
style='mso-bidi-font-weight:normal'><span lang=EN-US style='mso-ansi-language:
EN-US'>puts</span></b>(), <span class=SpellE><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-ansi-language:EN-US'>getc</span></b></span><b
style='mso-bidi-font-weight:normal'>() </b>и<b style='mso-bidi-font-weight:
normal'> </b><span class=SpellE><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='mso-ansi-language:EN-US'>putc</span></b></span><b
style='mso-bidi-font-weight:normal'>()</b>.</p>

<p class=P>Схожи не <span style='text-transform:uppercase'><span
style='mso-spacerun:yes'> </span></span>только параметры, но и действия.
Отличие лишь в том, что <span class=SpellE><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='mso-ansi-language:EN-US'>printf</span></b></span><b
style='mso-bidi-font-weight:normal'>(),</b> <span class=SpellE><b
style='mso-bidi-font-weight:normal'><span lang=EN-US style='mso-ansi-language:
EN-US'>scanf</span></b></span><b style='mso-bidi-font-weight:normal'>()</b> и
другие работают по умолчанию с консолью (экран, клавиатура), а <span
class=SpellE><b style='mso-bidi-font-weight:normal'><span lang=EN-US
style='mso-ansi-language:EN-US'>fprintf</span></b></span><b style='mso-bidi-font-weight:
normal'>(),</b> <span class=SpellE><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='mso-ansi-language:EN-US'>fscanf</span></b></span><b
style='mso-bidi-font-weight:normal'>()</b> — с файлами, поэтому у них добавлен
параметр, являющийся указателем на структуру <span lang=EN-US style='mso-ansi-language:
EN-US'>FILE</span>, которая была рассмотрена выше.</p>

<p class=P>Функции для работы с текстовыми файлами удобны для создания
текстовых файлов, ведения файлов-протоколов (<span lang=EN-US style='mso-ansi-language:
EN-US'>log</span>-файлов) и т.п.</p>

<p class=P>Прототипы вышеперечисленных функций:</p>

<p class=P><o:p>&nbsp;</o:p></p>

<p class=P><span lang=EN-US style='font-size:12.0pt;font-family:"Lucida Console";
mso-ansi-language:EN-US;mso-no-proof:yes'>int</span><span lang=EN-US
style='font-size:12.0pt;font-family:"Lucida Console";mso-no-proof:yes'> </span><span
lang=EN-US style='font-size:12.0pt;font-family:"Lucida Console";mso-ansi-language:
EN-US;mso-no-proof:yes'>fputs</span><span style='font-size:12.0pt;font-family:
"Lucida Console";mso-no-proof:yes'>(</span><span lang=EN-US style='font-size:
12.0pt;font-family:"Lucida Console";mso-ansi-language:EN-US;mso-no-proof:yes'>const</span><span
lang=EN-US style='font-size:12.0pt;font-family:"Lucida Console";mso-no-proof:
yes'> </span><span lang=EN-US style='font-size:12.0pt;font-family:"Lucida Console";
mso-ansi-language:EN-US;mso-no-proof:yes'>char</span><span style='font-size:
12.0pt;font-family:"Lucida Console";mso-no-proof:yes'> *</span><span
lang=EN-US style='font-size:12.0pt;font-family:"Lucida Console";mso-ansi-language:
EN-US;mso-no-proof:yes'>cmp</span><span style='font-size:12.0pt;font-family:
"Lucida Console";mso-no-proof:yes'>, </span><span lang=EN-US style='font-size:
12.0pt;font-family:"Lucida Console";mso-ansi-language:EN-US;mso-no-proof:yes'>FILE</span><span
style='font-size:12.0pt;font-family:"Lucida Console";mso-no-proof:yes'> *</span><span
lang=EN-US style='font-size:12.0pt;font-family:"Lucida Console";mso-ansi-language:
EN-US;mso-no-proof:yes'>file</span><span style='font-size:12.0pt;font-family:
"Lucida Console";mso-no-proof:yes'>);<o:p></o:p></span></p>

<p class=P><span lang=EN-US style='mso-ansi-language:EN-US;mso-no-proof:yes'>cmp</span><span
style='mso-no-proof:yes'> – указатель на строку;<o:p></o:p></span></p>

<p class=P><span lang=EN-US style='mso-ansi-language:EN-US;mso-no-proof:yes'>file</span><span
style='mso-no-proof:yes'> – указатель на файл;<o:p></o:p></span></p>

<p class=P><span style='mso-no-proof:yes'><o:p>&nbsp;</o:p></span></p>

<p class=P><span class=GramE><span lang=EN-US style='mso-ansi-language:EN-US;
mso-no-proof:yes'>fputs</span><span style='mso-no-proof:yes'>() пишет в файл, </span>указанный<span
style='mso-no-proof:yes'> в </span><span lang=EN-US style='mso-ansi-language:
EN-US;mso-no-proof:yes'>file</span><span style='mso-no-proof:yes'>, строку, на
которую указывает </span><span lang=EN-US style='mso-ansi-language:EN-US;
mso-no-proof:yes'>cmp</span><span style='mso-no-proof:yes'>.</span></span><span
style='mso-no-proof:yes'> Возвращает код последнего записанного в файл символа.
В случае возникновения ошибки – возвращается значение </span><span lang=EN-US
style='mso-ansi-language:EN-US;mso-no-proof:yes'>EOF</span><span
style='mso-no-proof:yes'>.<o:p></o:p></span></p>

<p class=P><span style='mso-no-proof:yes'><o:p>&nbsp;</o:p></span></p>

<p class=P><span class=SpellE><span class=GramE><span class=Code><span
lang=EN-US style='font-size:12.0pt;mso-ansi-language:EN-US'>int</span></span></span></span><span
class=Code><span lang=EN-US style='font-size:12.0pt;mso-ansi-language:EN-US'> <span
class=SpellE>fput</span></span></span><span class=Code><span style='font-size:
12.0pt'>с</span></span><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-ansi-language:EN-US'>(char <span class=SpellE>ch</span>, FILE *file);<o:p></o:p></span></span></p>

<p class=P><span lang=EN-US style='mso-ansi-language:EN-US;mso-no-proof:yes'>ch</span><span
style='mso-no-proof:yes'> – символ;<o:p></o:p></span></p>

<p class=P><span lang=EN-US style='mso-ansi-language:EN-US;mso-no-proof:yes'>file</span><span
style='mso-no-proof:yes'> – указатель на файл;<o:p></o:p></span></p>

<p class=P><span lang=EN-US style='mso-ansi-language:EN-US;mso-no-proof:yes'>fputc</span><span
style='mso-no-proof:yes'>() пишет в файл, указанный в </span><span lang=EN-US
style='mso-ansi-language:EN-US;mso-no-proof:yes'>file</span><span
style='mso-no-proof:yes'>, символ </span><span lang=EN-US style='mso-ansi-language:
EN-US;mso-no-proof:yes'>ch</span><span style='mso-no-proof:yes'>.<o:p></o:p></span></p>

<p class=P><span style='mso-no-proof:yes'>Возвращаемое значение – записанный
символ.<o:p></o:p></span></p>

<p class=P><span style='mso-no-proof:yes'>В случае возникновения ошибки –
возвращается значение </span><span lang=EN-US style='mso-ansi-language:EN-US;
mso-no-proof:yes'>EOF</span><span style='mso-no-proof:yes'>.<o:p></o:p></span></p>

<p class=P><span style='mso-no-proof:yes'><o:p>&nbsp;</o:p></span></p>

<p class=P><span class=GramE><span class=Code><span lang=EN-US
style='font-size:12.0pt;mso-ansi-language:EN-US'>char</span></span></span><span
class=Code><span lang=EN-US style='font-size:12.0pt;mso-ansi-language:EN-US'> *<span
class=SpellE>fgets</span>(char *<span class=SpellE>cmp</span>, <span
class=SpellE>int</span> length, FILE *file);<o:p></o:p></span></span></p>

<p class=P><span lang=EN-US style='mso-ansi-language:EN-US;mso-no-proof:yes'>cmp</span><span
style='mso-no-proof:yes'> – указатель на строку;<o:p></o:p></span></p>

<p class=P><span lang=EN-US style='mso-ansi-language:EN-US;mso-no-proof:yes'>file</span><span
style='mso-no-proof:yes'> – указатель на файл;<o:p></o:p></span></p>

<p class=P><span style='font-size:13.0pt;mso-bidi-font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=P>Функция <span class=SpellE><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='mso-ansi-language:EN-US'>fgets</span></b></span><b
style='mso-bidi-font-weight:normal'>() </b>читает<b style='mso-bidi-font-weight:
normal'> </b>из файла <b style='mso-bidi-font-weight:normal'><span lang=EN-US
style='mso-ansi-language:EN-US'>file</span></b> строку, и делает это до тех
пор, пока не будет прочитан символ новой строки или количество прочитанных
символов не будет равно <b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='mso-ansi-language:EN-US'>length</span></b>-1 <span
class=GramE>либо достигнут конец</span> файла.</p>

<p class=P>При успешном выполнении функция возвращает <span class=SpellE><b
style='mso-bidi-font-weight:normal'><span lang=EN-US style='mso-ansi-language:
EN-US'>cmp</span></b></span>, а в случае <span style='mso-no-proof:yes'>ошибки</span>
– пустой указатель (<span lang=EN-US style='mso-ansi-language:EN-US'>NULL</span>).</p>

<p class=P><b style='mso-bidi-font-weight:normal'><o:p>&nbsp;</o:p></b></p>

<p class=P><span class=SpellE><span class=Code><span style='font-size:12.0pt'>int</span></span></span><span
class=Code><span style='font-size:12.0pt'> <span class=SpellE>fget<span
class=GramE>с</span></span>(FILE *<span class=SpellE>file</span>);<o:p></o:p></span></span></p>

<p class=P><b style='mso-bidi-font-weight:normal'><span lang=EN-US
style='font-size:13.0pt;mso-bidi-font-size:10.0pt;mso-ansi-language:EN-US;
mso-no-proof:yes'>file</span></b><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='font-size:13.0pt;mso-bidi-font-size:10.0pt;mso-no-proof:yes'>
</span></b><span style='font-size:13.0pt;mso-bidi-font-size:10.0pt;mso-no-proof:
yes'>–</span><span style='mso-no-proof:yes'> указатель на файл;</span><span
style='font-size:13.0pt;mso-bidi-font-size:10.0pt;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=P><b style='mso-bidi-font-weight:normal'><span lang=EN-US
style='mso-ansi-language:EN-US;mso-no-proof:yes'>fgetc</span><span
style='mso-no-proof:yes'>()</span></b><span style='mso-no-proof:yes'>
возвращает символ прочитанный из файла </span><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-ansi-language:EN-US;mso-no-proof:yes'>file</span></b><span
style='mso-no-proof:yes'>, находящийся после текущей позиции в файле.<o:p></o:p></span></p>

<p class=P><span style='mso-no-proof:yes'>В случае возникновения ошибки, либо
по достижении конца файла – возвращается значение </span><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-ansi-language:EN-US;mso-no-proof:yes'>EOF</span></b><span
style='mso-no-proof:yes'>.<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:27.0pt'><span style='mso-no-proof:yes'><o:p>&nbsp;</o:p></span></p>

<p class=P><span style='mso-no-proof:yes'>Функцию </span><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-ansi-language:EN-US;mso-no-proof:yes'>fget</span><span
style='mso-no-proof:yes'>с() </span></b><span style='mso-no-proof:yes'>можно
использовать при работе с текстовыми файлами для прочтения символов до конца
файла.<b style='mso-bidi-font-weight:normal'> <o:p></o:p></b></span></p>

<p class=P><span style='mso-no-proof:yes'>Для этого нужно написать следующий
код в теле программы<o:p></o:p></span></p>

<p class=P><span style='mso-no-proof:yes'><o:p>&nbsp;</o:p></span></p>

<p class=P><span class=SpellE><span class=Code><span style='font-size:12.0pt'>do</span></span></span><span
class=Code><span style='font-size:12.0pt'><o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'>{<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'><span
style='mso-spacerun:yes'>  </span><span class=SpellE>ch</span> = <span
class=SpellE>fgetc</span>(<span class=SpellE>f</span>); // f-указатель на файл;<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'>}<o:p></o:p></span></span></p>

<p class=P><span class=SpellE><span class=Code><span style='font-size:12.0pt'>while</span></span></span><span
class=Code><span style='font-size:12.0pt'> (<span class=SpellE>ch</span><span
class=GramE> !</span>= <span class=GramE>EOF);</span><o:p></o:p></span></span></p>

<p class=P><o:p>&nbsp;</o:p></p>

<p class=P>Однако при ошибке функция<span style='mso-spacerun:yes'>  </span><span
class=SpellE><b style='mso-bidi-font-weight:normal'><span lang=EN-US
style='mso-ansi-language:EN-US'>fgetc</span></b></span><b style='mso-bidi-font-weight:
normal'>() </b>также возвращает <span lang=EN-US style='mso-ansi-language:EN-US'>EOF</span>,
<span class=GramE>следовательно</span> она не очень удобна в работе. Для <span
style='mso-no-proof:yes'>проверки</span> того, произошла ли ошибка нужно
использовать функцию <span class=SpellE><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='mso-ansi-language:EN-US'>ferror</span></b></span><b
style='mso-bidi-font-weight:normal'>(). </b></p>

<p class=P><span style='mso-no-proof:yes'>Еще одним важным недостатком такого
определения конца файла является невозможность работать с бинарными файлами.<o:p></o:p></span></p>

<p class=P><span style='mso-no-proof:yes'>Физически это, конечно, возможно,
однако при работе с двоичным файлом может быть прочитано целое значение равное EOF.<o:p></o:p></span></p>

<p class=P><span style='mso-no-proof:yes'>Поэтому во многих случаях удобнее
использовать функцию <b style='mso-bidi-font-weight:normal'>feof</b>(),
описание которой приведено ниже. <o:p></o:p></span></p>

<p class=P><span style='mso-no-proof:yes'>Ниже приведен пример программы записи
строковых данных в текстовый файл.<o:p></o:p></span></p>

<p class=P><span style='mso-fareast-font-family:"MS Mincho"'><o:p>&nbsp;</o:p></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'>#<span class=SpellE>include</span> &lt;<span class=SpellE>stdio.h</span>&gt;<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'>#<span class=SpellE>include</span> &lt;<span class=SpellE>conio.h</span>&gt;
// заголовочный файл для работы функции<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'><span style='mso-spacerun:yes'>                   </span></span></span><span
class=Code><span lang=EN-US style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho";mso-ansi-language:EN-US'>// </span></span><span class=Code><span
style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho"'>очистки</span></span><span
class=Code><span style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'> </span></span><span class=Code><span
style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho"'>экрана</span></span><span
class=Code><span lang=EN-US style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho";mso-ansi-language:EN-US'> (<span class=SpellE><span class=GramE>clrscr</span></span><span
class=GramE>(</span>))<o:p></o:p></span></span></p>

<p class=P><span class=GramE><span class=Code><span lang=EN-US
style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho";mso-ansi-language:
EN-US'>void</span></span></span><span class=Code><span lang=EN-US
style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho";mso-ansi-language:
EN-US'> main(void)<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'>{<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span><span class=GramE>char</span> s[25];<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>FILE *out;<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span><span class=SpellE><span class=GramE>clrscr</span></span><span
class=GramE>(</span>);<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span><span class=GramE>out</span> = <span
class=SpellE>fopen</span>(&quot;d:\\Ex2.txt&quot;, &quot;wt&quot;);<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span><span class=GramE>for</span> (<span
class=SpellE>int</span> <span class=SpellE>i</span> = 0; <span class=SpellE>i</span>
&lt; 3; <span class=SpellE>i</span>++)<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>{<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span><span class=GramE>gets(</span>s);<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span><span class=SpellE><span class=GramE>fprintf</span></span><span
class=GramE>(</span>out, &quot;%s \n&quot;, s);<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span></span></span><span class=Code><span
style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho"'>}<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'><span style='mso-spacerun:yes'>  </span><span class=SpellE>getch</span>();<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'><span style='mso-spacerun:yes'>  </span><span class=SpellE>fclose</span>(<span
class=SpellE>out</span>);<span style='mso-spacerun:yes'>     </span>// открытый
файл закрывается<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'><span style='mso-spacerun:yes'>  </span><span class=SpellE>puts</span>(&quot;<span
class=SpellE>Reading</span> <span class=SpellE>from</span> <span class=SpellE>file</span>&quot;);<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'><o:p>&nbsp;</o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'><span style='mso-spacerun:yes'>  </span>// тот же файл открывается
для чтения<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'><span style='mso-spacerun:yes'>  </span></span></span><span
class=GramE><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'>out</span></span></span><span
class=Code><span lang=EN-US style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho";mso-ansi-language:EN-US'> = <span class=SpellE>fopen</span>(&quot;d:\\Ex2.txt&quot;,
&quot;<span class=SpellE>rb</span>&quot;);<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span><span class=GramE>for</span> (<span
class=SpellE>i</span> = 0; <span class=SpellE>i</span> &lt; 3; <span
class=SpellE>i</span>++)<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>{<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span><span class=SpellE><span class=GramE>fscanf</span></span><span
class=GramE>(</span>out, &quot;%s&quot;, s);<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span><span class=SpellE><span class=GramE>printf</span></span><span
class=GramE>(</span>&quot;%s \n&quot;, s);<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>}<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span><span class=SpellE><span class=GramE>fclose</span></span><span
class=GramE>(</span>out);<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span></span></span><span class=SpellE><span
class=Code><span style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho"'>getch</span></span></span><span
class=Code><span style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho"'>();<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'>}<o:p></o:p></span></span></p>

<p class=P><o:p>&nbsp;</o:p></p>

<p class=P>В программе поочередно считываются и <span style='mso-no-proof:yes'>заносятся</span>
в файл три строки. </p>

<p class=P>Если открыть созданный файл (<span lang=EN-US style='mso-ansi-language:
EN-US'>d</span>:\<span lang=EN-US style='mso-ansi-language:EN-US'>ex</span>2.<span
lang=EN-US style='mso-ansi-language:EN-US'>txt</span>), к <span class=GramE>примеру</span>
редактором <span lang=EN-US style='mso-ansi-language:EN-US'>WORDPAD</span>, то
мы увидим, что данные <span style='mso-no-proof:yes'>располагаются</span> точно
так же, как мы видели их на экране.</p>

<p class=H2 style='mso-outline-level:3'><a name="_Toc266272306"></a><a
name="_Toc265340346"></a><a name="_Toc263373117"></a><a
name="_Позиционирование_в_файле"></a><span style='mso-bookmark:_Toc266272306'><span
style='mso-bookmark:_Toc265340346'><span style='mso-bookmark:_Toc263373117'><span
style='mso-ansi-language:RU'>10.4. Произвольный доступ к файлу</span></span></span></span><span
style='mso-ansi-language:RU'><o:p></o:p></span></p>

<p class=P><span style='mso-no-proof:yes'>Каждый открытый файл имеет так
называемый указатель на текущую позицию в файле. Все операции над файлами
(чтение и запись) работают с данными с этой позиции. При открытии файла
указатель текущей позиции в файле устанавливается на начало файла (кроме
режимов ‘</span><span lang=EN-US style='mso-ansi-language:EN-US;mso-no-proof:
yes'>a</span><span style='mso-no-proof:yes'>’ и ‘</span><span lang=EN-US
style='mso-ansi-language:EN-US;mso-no-proof:yes'>a</span><span
style='mso-no-proof:yes'>+’).<o:p></o:p></span></p>

<p class=P><span style='mso-no-proof:yes'>При каждом выполнении чтения или
записи, указатель смещается на количество прочитанных или записанных байт, то
есть устанавливается сразу за прочитанным или записанным блоком данных в файле.
Это так называемый последовательный доступ к данным. <o:p></o:p></span></p>

<p class=P><span style='mso-no-proof:yes'>Возьмем, к примеру, какой-нибудь
текстовый файл.<o:p></o:p></span></p>

<p class=P><span style='font-size:12.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=IMG><!--[if gte vml 1]><v:shape id="_x0000_i1026" type="#_x0000_t75"
 style='width:472.5pt;height:119.25pt'>
 <v:imagedata src="10%20ФАЙЛЫ.files/image002.png" o:title="127"/>
</v:shape><![endif]--><![if !vml]><img width=630 height=159
src="10%20ФАЙЛЫ.files/image003.jpg" v:shapes="_x0000_i1026"><![endif]></p>

<p class=P><o:p>&nbsp;</o:p></p>

<p class=P><span class=Code><span style='font-size:12.0pt'>...<o:p></o:p></span></span></p>

<p class=P><span class=SpellE><span class=Code><span style='font-size:12.0pt'>char</span></span></span><span
class=Code><span style='font-size:12.0pt'> <span class=SpellE>ch</span>;<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'>...<o:p></o:p></span></span></p>

<p class=P><span style='mso-no-proof:yes'><o:p>&nbsp;</o:p></span></p>

<p class=P><span style='mso-no-proof:yes'>К примеру, мы вызвали функцию fscanf(f,“%c”,
&amp;ch);<o:p></o:p></span></p>

<p class=P><span style='mso-no-proof:yes'>f – указатель<span
style='mso-spacerun:yes'>  </span>на файл, открытый функцией fopen();<o:p></o:p></span></p>

<p class=P><span style='mso-no-proof:yes'>После этого указатель сместится на sizeof(ch),
т.е. на 1 байт.<o:p></o:p></span></p>

<p class=P><span style='mso-no-proof:yes'>Последовательный доступ очень удобен,
он демонстрируется во всех вышеприведенных примерах чтения и записи в файл. <o:p></o:p></span></p>

<p class=P><span style='mso-no-proof:yes'>Но иногда необходимо читать или
писать данные в произвольном порядке. Это достигается путем установки указателя
на некоторую заданную позицию в файле функцией fseek().<o:p></o:p></span></p>

<p class=P><o:p>&nbsp;</o:p></p>

<p class=P><span class=SpellE><span class=GramE><span class=Code><span
lang=EN-US style='font-size:12.0pt;mso-ansi-language:EN-US'>int</span></span></span></span><span
class=Code><span lang=EN-US style='font-size:12.0pt;mso-ansi-language:EN-US'> <span
class=SpellE>fseek</span>(FILE *stream, long offset, <span class=SpellE>int</span>
whence);<o:p></o:p></span></span></p>

<p class=P><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=P><span style='mso-no-proof:yes'>Параметр offset задает количество
байт, на которое необходимо сместить указатель в направлении, указанном whence
в файле stream.<o:p></o:p></span></p>

<p class=P><span style='mso-no-proof:yes'>В<span style='mso-spacerun:yes'> 
</span>таблице 10.2 приведены возможные значения параметра whence:<o:p></o:p></span></p>

<p class=P><o:p>&nbsp;</o:p></p>

<p class=P align=center style='text-align:center;text-indent:0cm'>Таблица 10.2.
Значения параметра <span lang=EN-US style='mso-ansi-language:EN-US'>whence</span></p>

<p class=IMG><o:p>&nbsp;</o:p></p>

<div align=center>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;border:none;mso-border-alt:
 solid windowtext 1.0pt;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:
 1.0pt solid windowtext;mso-border-insidev:1.0pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;height:12.0pt'>
  <td width=155 valign=top style='width:116.6pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:12.0pt'>
  <p class=MsoNormal style='text-indent:27.0pt'><span lang=EN-US
  style='font-size:14.0pt;mso-ansi-language:EN-US'>SEEK</span><span
  style='font-size:14.0pt'>_</span><span lang=EN-US style='font-size:14.0pt;
  mso-ansi-language:EN-US'>SET</span><span style='font-size:14.0pt'><o:p></o:p></span></p>
  </td>
  <td width=105 valign=top style='width:78.8pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext 1.0pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:12.0pt'>
  <p class=MsoNormal style='text-indent:27.0pt'><span style='font-size:14.0pt'>0<o:p></o:p></span></p>
  </td>
  <td width=375 valign=top style='width:281.6pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext 1.0pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:12.0pt'>
  <p class=MsoNormal style='text-indent:27.0pt'><span style='font-size:14.0pt'>Смещение
  от начала файла<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;height:12.0pt'>
  <td width=155 valign=top style='width:116.6pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext 1.0pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:12.0pt'>
  <p class=MsoNormal style='text-indent:27.0pt'><span lang=EN-US
  style='font-size:14.0pt;mso-ansi-language:EN-US'>SEEK</span><span
  style='font-size:14.0pt'>_</span><span lang=EN-US style='font-size:14.0pt;
  mso-ansi-language:EN-US'>CUR</span><span style='font-size:14.0pt'><o:p></o:p></span></p>
  </td>
  <td width=105 valign=top style='width:78.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext 1.0pt;mso-border-left-alt:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:12.0pt'>
  <p class=MsoNormal style='text-indent:27.0pt'><span style='font-size:14.0pt'>1<o:p></o:p></span></p>
  </td>
  <td width=375 valign=top style='width:281.6pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext 1.0pt;mso-border-left-alt:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:12.0pt'>
  <p class=MsoNormal style='text-indent:27.0pt'><span style='font-size:14.0pt'>Смещение
  от текущей позиции<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2;mso-yfti-lastrow:yes;height:12.0pt'>
  <td width=155 valign=top style='width:116.6pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext 1.0pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:12.0pt'>
  <p class=MsoNormal style='text-indent:27.0pt'><span lang=EN-US
  style='font-size:14.0pt;mso-ansi-language:EN-US'>SEEK</span><span
  style='font-size:14.0pt'>_</span><span lang=EN-US style='font-size:14.0pt;
  mso-ansi-language:EN-US'>END</span><span style='font-size:14.0pt'><o:p></o:p></span></p>
  </td>
  <td width=105 valign=top style='width:78.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext 1.0pt;mso-border-left-alt:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:12.0pt'>
  <p class=MsoNormal style='text-indent:27.0pt'><span style='font-size:14.0pt'>2<o:p></o:p></span></p>
  </td>
  <td width=375 valign=top style='width:281.6pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext 1.0pt;mso-border-left-alt:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:12.0pt'>
  <p class=MsoNormal style='text-indent:27.0pt'><span style='font-size:14.0pt'>Смещение
  от конца файла<o:p></o:p></span></p>
  </td>
 </tr>
</table>

</div>

<p class=P><o:p>&nbsp;</o:p></p>

<p class=P>Величина смещения может быть как положительной, так отрицательной,
но нельзя сместиться за <span style='mso-no-proof:yes'>пределы</span> начала
файла.</p>

<p class=P><o:p>&nbsp;</o:p></p>

<p class=P><span class=Code><span style='font-size:12.0pt'>...<o:p></o:p></span></span></p>

<p class=P><span class=SpellE><span class=Code><span style='font-size:12.0pt'>fseek</span></span></span><span
class=Code><span style='font-size:12.0pt'>(<span class=SpellE>f</span>, 8,
SEEK_SET); // смещает указатель на <span class=GramE>текущую</span><o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'><span
style='mso-spacerun:yes'>                       </span>// позицию в файле на
восемь байт <span class=GramE>от</span><o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'><span
style='mso-spacerun:yes'>                 </span><span
style='mso-spacerun:yes'>      </span>// его текущего положения<o:p></o:p></span></span></p>

<p class=P><o:p>&nbsp;</o:p></p>

<p class=IMG><!--[if gte vml 1]><v:shape id="_x0000_i1027" type="#_x0000_t75"
 style='width:478.5pt;height:102.75pt'>
 <v:imagedata src="10%20ФАЙЛЫ.files/image004.gif" o:title="128"/>
</v:shape><![endif]--><![if !vml]><img width=638 height=137
src="10%20ФАЙЛЫ.files/image004.gif" v:shapes="_x0000_i1027"><![endif]></p>

<p class=P><o:p>&nbsp;</o:p></p>

<p class=P>Очень часто приходится сталкиваться с необходимостью узнать, где
сейчас находится указатель на позицию в файле. Для этого в библиотеке Си
содержится ряд функций. Ограничимся рассмотрением одной из них</p>

<p class=P><o:p>&nbsp;</o:p></p>

<p class=P><span class=GramE><span class=Code><span lang=EN-US
style='font-size:12.0pt;mso-ansi-language:EN-US'>long</span></span></span><span
class=Code><span lang=EN-US style='font-size:12.0pt;mso-ansi-language:EN-US'> <span
class=SpellE>int</span> <span class=SpellE>ftell</span>(FILE *file);<o:p></o:p></span></span></p>

<p class=P><span lang=EN-US style='mso-ansi-language:EN-US;mso-no-proof:yes'><o:p>&nbsp;</o:p></span></p>

<p class=P><span lang=EN-US style='mso-ansi-language:EN-US;mso-no-proof:yes'>file</span><span
style='mso-no-proof:yes'> – указатель на файл, возвращенный функцией </span><span
lang=EN-US style='mso-ansi-language:EN-US;mso-no-proof:yes'>fopen</span><span
style='mso-no-proof:yes'>().<o:p></o:p></span></p>

<p class=P><span style='mso-no-proof:yes'>Функция </span><span lang=EN-US
style='mso-ansi-language:EN-US;mso-no-proof:yes'>ftell</span><span
style='mso-no-proof:yes'>() возвращает текущее положение указателя файла в
байтах относительно начала файла. В случае ошибки возвращается значение -1</span><span
lang=EN-US style='mso-ansi-language:EN-US;mso-no-proof:yes'>L</span><span
style='mso-no-proof:yes'>.<o:p></o:p></span></p>

<p class=P><span style='mso-no-proof:yes'><o:p>&nbsp;</o:p></span></p>

<p class=P><span class=Code><span style='font-size:11.5pt'>#</span></span><span
class=Code><span lang=EN-US style='font-size:11.5pt;mso-ansi-language:EN-US'>include</span></span><span
class=Code><span style='font-size:11.5pt'> &lt;</span></span><span
class=SpellE><span class=Code><span lang=EN-US style='font-size:11.5pt;
mso-ansi-language:EN-US'>stdio</span></span></span><span class=Code><span
style='font-size:11.5pt'>.</span></span><span class=Code><span lang=EN-US
style='font-size:11.5pt;mso-ansi-language:EN-US'>h</span></span><span
class=Code><span style='font-size:11.5pt'>&gt;<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:11.5pt'><o:p>&nbsp;</o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:11.5pt'>// Функция
возвращает число байтов в файле<o:p></o:p></span></span></p>

<p class=P><span class=GramE><span class=Code><span lang=EN-US
style='font-size:11.5pt;mso-ansi-language:EN-US'>long</span></span></span><span
class=Code><span lang=EN-US style='font-size:11.5pt;mso-ansi-language:EN-US'> <span
class=SpellE>filesize</span>(FILE *f1)<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:11.5pt;
mso-ansi-language:EN-US'>{<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:11.5pt;
mso-ansi-language:EN-US'><span style='mso-spacerun:yes'>  </span><span
class=GramE>long</span> pos, length;<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:11.5pt;
mso-ansi-language:EN-US'><span style='mso-spacerun:yes'>  </span><span
class=GramE>pos</span> = <span class=SpellE>ftell</span>(f1);<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:11.5pt;
mso-ansi-language:EN-US'><span style='mso-spacerun:yes'>  </span><span
class=SpellE><span class=GramE>fseek</span></span><span class=GramE>(</span>f1,0L,SEEK_END);<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:11.5pt;
mso-ansi-language:EN-US'><span style='mso-spacerun:yes'>  </span><span
class=GramE>length</span> = <span class=SpellE>ftell</span>(f1);<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:11.5pt;
mso-ansi-language:EN-US'><span style='mso-spacerun:yes'>  </span><span
class=SpellE><span class=GramE>fseek</span></span><span class=GramE>(</span>f1,pos,SEEK_SET);<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:11.5pt;
mso-ansi-language:EN-US'><span style='mso-spacerun:yes'>  </span><span
class=GramE>return</span> (length);<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:11.5pt;
mso-ansi-language:EN-US'>}<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:11.5pt;
mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></span></p>

<p class=P><span class=SpellE><span class=GramE><span class=Code><span
lang=EN-US style='font-size:11.5pt;mso-ansi-language:EN-US'>int</span></span></span></span><span
class=Code><span lang=EN-US style='font-size:11.5pt;mso-ansi-language:EN-US'>
main()<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:11.5pt;
mso-ansi-language:EN-US'>{<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:11.5pt;
mso-ansi-language:EN-US'><span style='mso-spacerun:yes'>  </span>FILE *f;<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:11.5pt;
mso-ansi-language:EN-US'><span style='mso-spacerun:yes'>  </span>f = <span
class=SpellE><span class=GramE>fopen</span></span><span class=GramE>(</span>&quot;D:\\main.cpp&quot;,&quot;r&quot;);<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:11.5pt;
mso-ansi-language:EN-US'><span style='mso-spacerun:yes'>  </span><span
class=SpellE><span class=GramE>printf</span></span><span class=GramE>(</span>&quot;%<span
class=SpellE>ld&quot;,filesize</span>(f));<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:11.5pt;
mso-ansi-language:EN-US'><span style='mso-spacerun:yes'>  </span><span
class=SpellE><span class=GramE>fclose</span></span><span class=GramE>(</span>f);<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:11.5pt;
mso-ansi-language:EN-US'><span style='mso-spacerun:yes'>  </span><span
class=GramE>return</span></span></span><span class=Code><span style='font-size:
11.5pt'> 0;<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:11.5pt'>}<o:p></o:p></span></span></p>

<p class=P><span style='mso-no-proof:yes'><o:p>&nbsp;</o:p></span></p>

<p class=P><span style='mso-no-proof:yes'>Также часто возникает потребность в
проверке достижения конца файла.<o:p></o:p></span></p>

<p class=P><span style='mso-no-proof:yes'>Для этого используется функция feof().<o:p></o:p></span></p>

<p class=P><span style='mso-no-proof:yes'>Прототип</span><span lang=EN-US
style='mso-ansi-language:EN-US;mso-no-proof:yes'>:<o:p></o:p></span></p>

<p class=P><span lang=EN-US style='mso-ansi-language:EN-US;mso-no-proof:yes'><o:p>&nbsp;</o:p></span></p>

<p class=P><span class=SpellE><span class=GramE><span class=Code><span
lang=EN-US style='font-size:12.0pt;mso-ansi-language:EN-US'>int</span></span></span></span><span
class=Code><span lang=EN-US style='font-size:12.0pt;mso-ansi-language:EN-US'> <span
class=SpellE>feof</span>(FILE *file);<o:p></o:p></span></span></p>

<p class=P><span lang=EN-US style='mso-ansi-language:EN-US;mso-no-proof:yes'><o:p>&nbsp;</o:p></span></p>

<p class=P><span style='mso-no-proof:yes'>file – указатель на файл, открытый
функцией fopen();<o:p></o:p></span></p>

<p class=P><span style='mso-no-proof:yes'>Если достигнут конец файла, то
функция возвращает ненулевое значение, иначе – нуль.<o:p></o:p></span></p>

<p class=P><span style='mso-no-proof:yes'>Следующая программа осуществляет
запрос у пользователя номера структуры, которую необходимо вывести, смещается в
файле до этой структуры, считывает ее и выводит на экран.<o:p></o:p></span></p>

<p class=P><o:p>&nbsp;</o:p></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'>#include &lt;<span
class=SpellE>stdio.h</span>&gt;<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'>#include &lt;<span
class=SpellE>conio.h</span>&gt;<o:p></o:p></span></span></p>

<p class=P><span class=GramE><span class=Code><span lang=EN-US
style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho";mso-ansi-language:
EN-US'>void</span></span></span><span class=Code><span lang=EN-US
style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho";mso-ansi-language:
EN-US'> main(void)<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'>{<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span><span class=SpellE><span class=GramE>struct</span></span>
man<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>{<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span><span class=GramE>char</span> <span
class=SpellE>im</span>[10];<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span><span class=GramE>char</span> <span
class=SpellE>fam</span>[10];<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span><span class=GramE>char</span> <span
class=SpellE>ot</span>[10];<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span><span class=SpellE><span class=GramE>int</span></span>
<span class=SpellE>vozr</span>;<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>};<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>FILE *out;<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span><span class=GramE>man</span> m;<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span><span class=SpellE><span class=GramE>int</span></span>
c;<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span><span class=SpellE><span class=GramE>clrscr</span></span><span
class=GramE>(</span>);<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span><span class=GramE>if</span> (!(out = <span
class=SpellE>fopen</span>(&quot;d:\\Ex2_bin.txt&quot;, &quot;<span
class=SpellE>rb</span>&quot;))) return;<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span></span></span><span class=Code><span
style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho"'>//открывается файл
со структурами, созданными в примере 4<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'><span style='mso-spacerun:yes'>  </span></span></span><span
class=GramE><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'>do</span></span></span><span
class=Code><span lang=EN-US style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho";mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>{<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span><span class=SpellE><span class=GramE>clrscr</span></span><span
class=GramE>(</span>);<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span><span class=GramE>puts(</span>&quot;<span
class=SpellE>Vvedite</span> <span class=SpellE>nomer</span> <span class=SpellE>zapisi</span>&quot;);<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span></span></span><span class=SpellE><span
class=Code><span style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho"'>if</span></span></span><span
class=Code><span style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho"'>
((<span class=SpellE>c</span> = <span class=SpellE>getch</span>())<span
class=GramE> !</span>= '0') // считывается номер структуры<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'><span style='mso-spacerun:yes'>      </span><span class=SpellE>if</span>
((<span class=SpellE>c</span> &gt; '0') &amp;&amp; (<span class=SpellE>c</span>
&lt;= '3')) // т<span class=GramE>.к</span> у нас было создано<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'><span style='mso-spacerun:yes'>                                  
</span>// только 3 структуры<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'><span style='mso-spacerun:yes'>      </span>{<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'><span style='mso-spacerun:yes'>        </span><span class=SpellE>c</span>
= (<span class=SpellE>c</span> - '0') - 1;<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'><span style='mso-spacerun:yes'>        </span><span class=SpellE>puts</span>(&quot;<span
class=SpellE>Reading</span> <span class=SpellE>from</span> <span class=SpellE>file</span>&quot;);<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'><o:p>&nbsp;</o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'><span style='mso-spacerun:yes'>        </span>// смещаемся на
кол-во байт, равное размеру одной<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'><span style='mso-spacerun:yes'>        </span>// структуры, <span
class=GramE>умноженный</span> на с<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'><span style='mso-spacerun:yes'>        </span><span class=SpellE>fseek</span>(<span
class=SpellE>out</span>, <span class=SpellE>sizeof</span>(<span class=SpellE>m</span>)
* <span class=SpellE>c</span>, 0);<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'><span style='mso-spacerun:yes'>        </span><span class=SpellE>fread</span>(&amp;<span
class=SpellE>m</span>, <span class=SpellE>sizeof</span>(<span class=SpellE>m</span>),
1, <span class=SpellE>out</span>); // считываем структуру<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'><o:p>&nbsp;</o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'><span style='mso-spacerun:yes'>        </span></span></span><span
class=Code><span lang=EN-US style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho";mso-ansi-language:EN-US'>//</span></span><span class=Code><span
style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho"'>выводим</span></span><span
class=Code><span style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'> </span></span><span class=Code><span
style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho"'>структуру</span></span><span
class=Code><span lang=EN-US style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho";mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span><span class=SpellE><span class=GramE>printf</span></span><span
class=GramE>(</span>&quot;%s %s %s, <span class=SpellE>vozrast</span> (let) %<span
class=SpellE>i</span> \n&quot;,<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span><span class=SpellE>m.im</span>, <span
class=SpellE>m.fam</span>, <span class=SpellE>m.ot</span>, <span class=SpellE>m.vozr</span>);<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span></span></span><span class=SpellE><span
class=Code><span style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho"'>getch</span></span></span><span
class=Code><span style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho"'>();<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'><span style='mso-spacerun:yes'>      </span>}<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'><span style='mso-spacerun:yes'>  </span>}<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'><span style='mso-spacerun:yes'>  </span><span class=SpellE>while</span>
(<span class=SpellE>c</span><span class=GramE> !</span>= '0'); // 0 – признак
выхода<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'><span style='mso-spacerun:yes'>  </span><span class=SpellE>fclose</span>(<span
class=SpellE>out</span>);<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'>}</span></span><span class=Code><span style='font-size:12.0pt'><o:p></o:p></span></span></p>

<p class=H2 style='mso-outline-level:3'><a name="_Toc266272307"></a><a
name="_Toc265340347"></a><a name="_Toc263373118"></a><a name="_Кратко_о_других"></a><a
name="_Кратко_о_других_1"></a><span style='mso-bookmark:_Toc266272307'><span
style='mso-bookmark:_Toc265340347'><span style='mso-bookmark:_Toc263373118'><span
style='mso-ansi-language:RU'>10.5. Функции ввода-вывода <br>
для работы с бинарными файлами</span></span></span></span><span
style='mso-ansi-language:RU'><o:p></o:p></span></p>

<p class=P>Для создания, например, баз данных удобнее и целесообразнее будет
использовать не текстовый файл, а бинарный. В этом случае у нас появляется
возможность считывать всю структуру за один раз, а также имеется возможность
доступа к произвольной структуре. </p>

<p class=P><span style='mso-no-proof:yes'>Для работы с бинарными файлами нужно
использовать функции: </span><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='mso-ansi-language:EN-US;mso-no-proof:yes'>fwrite</span></b><span
style='mso-no-proof:yes'>() и </span><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='mso-ansi-language:EN-US;mso-no-proof:yes'>fread</span></b><span
style='mso-no-proof:yes'>(). <o:p></o:p></span></p>

<p class=P><b style='mso-bidi-font-weight:normal'><span style='font-size:13.0pt;
mso-bidi-font-size:10.0pt;mso-no-proof:yes'><o:p>&nbsp;</o:p></span></b></p>

<p class=P><span class=GramE><span class=Code><span lang=EN-US
style='font-size:12.0pt;mso-ansi-language:EN-US'>unsigned</span></span></span><span
class=Code><span lang=EN-US style='font-size:12.0pt;mso-ansi-language:EN-US'> <span
class=SpellE>fwrite</span>(void<span style='mso-spacerun:yes'>     </span>*<span
class=SpellE>ptr</span>,<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-ansi-language:EN-US'><span style='mso-spacerun:yes'>                </span><span
class=GramE>unsigned<span style='mso-spacerun:yes'>  </span>size</span>,<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-ansi-language:EN-US'><span style='mso-spacerun:yes'>                </span></span></span><span
class=SpellE><span class=Code><span style='font-size:12.0pt'>unsigned</span></span></span><span
class=Code><span style='font-size:12.0pt'><span style='mso-spacerun:yes'> 
</span><span class=SpellE>n</span>,<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'><span
style='mso-spacerun:yes'>                </span><span class=GramE>FILE<span
style='mso-spacerun:yes'>     </span>*<span class=SpellE>stream</span>);</span><o:p></o:p></span></span></p>

<p class=P><span style='mso-no-proof:yes'><o:p>&nbsp;</o:p></span></p>

<p class=P><span style='mso-no-proof:yes'>Здесь</span><span style='font-size:
13.0pt;mso-bidi-font-size:10.0pt;mso-no-proof:yes'> </span><span lang=EN-US
style='mso-ansi-language:EN-US;mso-no-proof:yes'>ptr</span><span
style='mso-no-proof:yes'> – адрес в памяти, начиная с которого будет прочитано </span><span
lang=EN-US style='mso-ansi-language:EN-US;mso-no-proof:yes'>size</span><span
style='mso-no-proof:yes'> байт </span><span lang=EN-US style='font-size:13.0pt;
mso-bidi-font-size:10.0pt;mso-ansi-language:EN-US;mso-no-proof:yes'>n</span><span
lang=EN-US style='font-size:13.0pt;mso-bidi-font-size:10.0pt;mso-no-proof:yes'>
</span><span style='mso-no-proof:yes'>раз и записано в файл<span
style='mso-spacerun:yes'>  </span></span><span lang=EN-US style='mso-ansi-language:
EN-US;mso-no-proof:yes'>stream</span><span style='mso-no-proof:yes'>.
Возвращает количество записанных элементов.<o:p></o:p></span></p>

<p class=P><span style='mso-no-proof:yes'><o:p>&nbsp;</o:p></span></p>

<p class=P><span class=SpellE><span class=GramE><span class=Code><span
style='font-size:12.0pt'>unsigned</span></span></span></span><span class=GramE><span
class=Code><span style='font-size:12.0pt'> <span class=SpellE>fread</span>(<span
class=SpellE>void</span><span style='mso-spacerun:yes'>     </span>*<span
class=SpellE>ptr</span>,</span></span></span><span class=Code><span
style='font-size:12.0pt'><o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'><span
style='mso-spacerun:yes'>               </span><span class=SpellE>unsigned</span><span
style='mso-spacerun:yes'>  </span><span class=SpellE>size</span>,<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'><span
style='mso-spacerun:yes'>               </span><span class=SpellE>unsigned</span><span
style='mso-spacerun:yes'>  </span><span class=SpellE>n</span>,<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt'><span
style='mso-spacerun:yes'>               </span><span class=GramE>FILE<span
style='mso-spacerun:yes'>     </span>*<span class=SpellE>stream</span>);</span><o:p></o:p></span></span></p>

<p class=P><span style='mso-no-proof:yes'><o:p>&nbsp;</o:p></span></p>

<p class=P><span style='mso-no-proof:yes'>Здесь</span><span style='font-size:
13.0pt;mso-bidi-font-size:10.0pt;mso-no-proof:yes'> </span><span lang=EN-US
style='mso-ansi-language:EN-US;mso-no-proof:yes'>ptr</span><span
style='mso-no-proof:yes'> – адрес в памяти, начиная с которого будет записано </span><span
lang=EN-US style='mso-ansi-language:EN-US;mso-no-proof:yes'>size</span><span
style='mso-no-proof:yes'> байт </span><span lang=EN-US style='font-size:13.0pt;
mso-bidi-font-size:10.0pt;mso-ansi-language:EN-US;mso-no-proof:yes'>n</span><span
lang=EN-US style='font-size:13.0pt;mso-bidi-font-size:10.0pt;mso-no-proof:yes'>
</span>раз из <span style='mso-no-proof:yes'>файла<span
style='mso-spacerun:yes'>  </span>stream. Возвращает количество прочитанных
элементов.<o:p></o:p></span></p>

<p class=P><span style='mso-no-proof:yes'>Эти функции</span> без каких-либо
изменений копируют блок данных из оперативной памяти в файл и из файла в память
соответственно. По этой причине <span class=SpellE><span lang=EN-US
style='mso-ansi-language:EN-US'>fread</span></span>() и <span class=SpellE><span
lang=EN-US style='mso-ansi-language:EN-US'>fwrite</span></span>() работают
быстрее, чем функции чтения и записи для текстовых файлов.</p>

<p class=P>В нижеприведенной программе создается структура, состоящая из
четырех полей, которые описывают имя, фамилию, отчество и возраст человека.
Данные запрашиваются три раза, и каждый раз структура заносится в бинарный
файл.</p>

<p class=P><o:p>&nbsp;</o:p></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'>#include &lt;<span
class=SpellE>stdio.h</span>&gt;<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'>#include &lt;<span
class=SpellE>conio.h</span>&gt;<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></span></p>

<p class=P><span class=GramE><span class=Code><span lang=EN-US
style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho";mso-ansi-language:
EN-US'>void</span></span></span><span class=Code><span lang=EN-US
style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho";mso-ansi-language:
EN-US'> main(void)<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'>{<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span><span class=SpellE><span class=GramE>struct</span></span>
man<span style='mso-spacerun:yes'>      </span>// </span></span><span
class=Code><span style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho"'>Создаваемая</span></span><span
class=Code><span style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'> </span></span><span class=SpellE><span class=Code><span
style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho"'>стуктура</span></span></span><span
class=Code><span lang=EN-US style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho";mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>{<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span><span class=GramE>char</span> <span
class=SpellE>im</span>[10];<span style='mso-spacerun:yes'>  </span>// </span></span><span
class=Code><span style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho"'>Имя</span></span><span
class=Code><span lang=EN-US style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho";mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span><span class=GramE>char</span> <span
class=SpellE>fam</span>[10]; // </span></span><span class=Code><span
style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho"'>Фамилия</span></span><span
class=Code><span lang=EN-US style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho";mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span><span class=GramE>char</span> <span
class=SpellE>ot</span>[10];<span style='mso-spacerun:yes'>  </span>// </span></span><span
class=Code><span style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho"'>Отчество</span></span><span
class=Code><span lang=EN-US style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho";mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span><span style='mso-spacerun:yes'> </span><span
class=SpellE><span class=GramE>int</span></span> <span class=SpellE>vozr</span>;<span
style='mso-spacerun:yes'>     </span>// </span></span><span class=Code><span
style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho"'>Возраст</span></span><span
class=Code><span lang=EN-US style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho";mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>};<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>FILE *out;<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span><span class=GramE>man</span> m;<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span><span class=SpellE><span class=GramE>clrscr</span></span><span
class=GramE>(</span>);<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span><span class=GramE>out</span> = <span
class=SpellE>fopen</span>(&quot;d:\\Ex2_bin.txt&quot;, &quot;<span
class=SpellE>wb</span>&quot;);<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span><span class=GramE>for</span> (<span
class=SpellE>int</span> <span class=SpellE>i</span> = 0; <span class=SpellE>i</span>
&lt; 3; <span class=SpellE>i</span>++)<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>{<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span><span class=GramE>puts(</span>&quot;Enter <span
class=SpellE>Imia</span>&quot;);<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span><span class=GramE>scanf(</span>&quot;%s&quot;,
m.im);<span style='mso-spacerun:yes'>    </span>//</span></span><span
class=Code><span style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho"'>Считывается</span></span><span
class=Code><span style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'> </span></span><span class=Code><span
style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho"'>имя</span></span><span
class=Code><span lang=EN-US style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho";mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span><span class=GramE>puts(</span>&quot;Enter <span
class=SpellE>Familiu</span>&quot;);<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span><span class=SpellE><span class=GramE>scanf</span></span><span
class=GramE>(</span>&quot;%s&quot;, <span class=SpellE>m.fam</span>);<span
style='mso-spacerun:yes'>   </span>//</span></span><span class=Code><span
style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho"'>Считывается</span></span><span
class=Code><span style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'> </span></span><span class=Code><span
style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho"'>фамилия</span></span><span
class=Code><span lang=EN-US style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho";mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span><span class=GramE>puts(</span>&quot;Enter <span
class=SpellE>Otchestvo</span>&quot;);<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span><span class=SpellE><span class=GramE>scanf</span></span><span
class=GramE>(</span>&quot;%s&quot;, <span class=SpellE>m.ot</span>);<span
style='mso-spacerun:yes'>    </span>//</span></span><span class=Code><span
style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho"'>Считывается</span></span><span
class=Code><span style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'> </span></span><span class=Code><span
style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho"'>отчество</span></span><span
class=Code><span lang=EN-US style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho";mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span><span class=GramE>puts(</span>&quot;Enter <span
class=SpellE>Vozrast</span>&quot;);<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span><span class=SpellE><span class=GramE>scanf</span></span><span
class=GramE>(</span>&quot;%<span class=SpellE>i</span>&quot;, &amp;<span
class=SpellE>m.vozr</span>); //</span></span><span class=Code><span
style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho"'>Считывается</span></span><span
class=Code><span style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'> </span></span><span class=Code><span
style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho"'>возраст</span></span><span
class=Code><span lang=EN-US style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho";mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span></span></span><span class=Code><span
style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho"'>// Осуществляется
запись в файл<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'><span style='mso-spacerun:yes'>    </span><span class=SpellE>fwrite</span>(&amp;<span
class=SpellE>m</span>, <span class=SpellE>sizeof</span>(<span class=SpellE>m</span>),
1, <span class=SpellE>out</span>);<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'><span style='mso-spacerun:yes'>  </span></span></span><span
class=Code><span lang=EN-US style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho";mso-ansi-language:EN-US'>}<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span><span class=SpellE><span class=GramE>getch</span></span><span
class=GramE>(</span>);<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span><span class=SpellE><span class=GramE>fclose</span></span><span
class=GramE>(</span>out);<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span><span class=SpellE><span class=GramE>clrscr</span></span><span
class=GramE>(</span>);<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span><span class=GramE>puts(</span>&quot;<st1:place
w:st="on"><st1:City w:st="on">Reading</st1:City></st1:place> from file&quot;);<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span></span></span><span class=Code><span
style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho"'>// файл
открывается для чтения<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'><span style='mso-spacerun:yes'>  </span><span class=SpellE><span
class=GramE>out</span></span><span class=GramE> = <span class=SpellE>fopen</span>(&quot;d:</span>\\<span
class=GramE>Ex2_bin.txt&quot;, &quot;<span class=SpellE>rb</span>&quot;);</span><o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'><span style='mso-spacerun:yes'>  </span><span class=SpellE>for</span>
(<span class=SpellE>i</span> = 0; <span class=SpellE>i</span> &lt; 3; <span
class=SpellE>i++</span>)<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'><span style='mso-spacerun:yes'>  </span>{<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'><span style='mso-spacerun:yes'>    </span>// считывается кол-во
байт, <span class=GramE>занимаемых</span> одной структурой<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'><span style='mso-spacerun:yes'>    </span></span></span><span
class=SpellE><span class=GramE><span class=Code><span lang=EN-US
style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho";mso-ansi-language:
EN-US'>fread</span></span></span></span><span class=GramE><span class=Code><span
lang=EN-US style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>(</span></span></span><span class=Code><span
lang=EN-US style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>&amp;m, <span class=SpellE>sizeof</span>(m), 1, out);<o:p></o:p></span></span></p>

<p class=P><span class=Code><span lang=EN-US style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span></span></span><span class=Code><span
style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho"'>//вывод на экран
считанной структуры<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'><span style='mso-spacerun:yes'>    </span><span class=SpellE><span
class=GramE>printf</span></span><span class=GramE>(&quot;%<span class=SpellE>s</span>
%<span class=SpellE>s</span> %<span class=SpellE>s</span>, <span class=SpellE>vozrast</span>
(<span class=SpellE>let</span>) %<span class=SpellE>i</span> \<span
class=SpellE>n</span>&quot;,</span><o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'><span style='mso-spacerun:yes'>           </span><span
class=SpellE><span class=GramE>m.im</span></span><span class=GramE>, <span
class=SpellE>m.fam</span>, <span class=SpellE>m.ot</span>, <span class=SpellE>m.vozr</span>);</span><o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'><span style='mso-spacerun:yes'>  </span>}<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'><span style='mso-spacerun:yes'>  </span><span class=SpellE>fclose</span>(<span
class=SpellE>out</span>);<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'><span style='mso-spacerun:yes'>  </span><span class=SpellE>getch</span>();<o:p></o:p></span></span></p>

<p class=P><span class=Code><span style='font-size:12.0pt;mso-fareast-font-family:
"MS Mincho"'>}<o:p></o:p></span></span></p>

<p class=P><span style='mso-fareast-font-family:"MS Mincho"'><o:p>&nbsp;</o:p></span></p>

<p class=P><span style='mso-fareast-font-family:"MS Mincho"'>Все операции
чтения/записи производятся через внутренний буфер в оперативной памяти (ОП).<o:p></o:p></span></p>

<p class=P><span style='mso-fareast-font-family:"MS Mincho"'>Может возникнуть
такая ситуация, что данные, содержащиеся в буфере, могут быть утеряны и,
соответственно, не записаны в файл.<o:p></o:p></span></p>

<p class=P><span style='mso-fareast-font-family:"MS Mincho"'>Для принудительной
записи содержимого буфера в файл используется функция </span><span
class=SpellE><b style='mso-bidi-font-weight:normal'><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'>fflush</span></b></span><b
style='mso-bidi-font-weight:normal'><span style='mso-fareast-font-family:"MS Mincho"'>().<o:p></o:p></span></b></p>

<p class=P><span style='mso-fareast-font-family:"MS Mincho"'><o:p>&nbsp;</o:p></span></p>

<p class=P><span class=SpellE><span class=Code><span style='font-size:12.0pt;
mso-fareast-font-family:"MS Mincho"'>int</span></span></span><span class=Code><span
style='font-size:12.0pt;mso-fareast-font-family:"MS Mincho"'> <span
class=SpellE>fflush</span>(FILE *<span class=SpellE>file</span>);<o:p></o:p></span></span></p>

<p class=P><span style='mso-fareast-font-family:"MS Mincho"'><o:p>&nbsp;</o:p></span></p>

<p class=P><span class=SpellE><span class=GramE><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'>fflush</span></span></span><span
class=GramE><span style='mso-fareast-font-family:"MS Mincho"'>(</span></span><span
style='mso-fareast-font-family:"MS Mincho"'>) записывает содержимое буфера в
файл </span><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>file</span><span style='mso-fareast-font-family:"MS Mincho"'>,
файл при этом остается открытым. Возвращает ноль при успешном выполнении;<span
style='mso-spacerun:yes'>  </span>ненулевое<span style='mso-spacerun:yes'> 
</span>значение – при ошибке.</span><span style='font-family:"Courier New";
mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=P>Если программа завершается нормально, то содержимое буфера <span
class=SpellE>дозаписывается</span> автоматически. </p>

<p class=P>Полезно знать, что текстовый файл, в принципе, не отличается от <span
class=GramE>бинарного</span>, поэтому любой бинарный файл может быть открыт для
работы с ним, как с текстовым; а текстовый может быть открыт как бинарный. Но
такой способ работы с файлом может приводить к ошибкам. Поэтому рекомендуется
работать с конкретным файлом в том режиме, в котором он был создан.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

</div>

</body>

</html>
